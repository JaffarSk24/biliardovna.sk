{% extends "base.twig" %}

{% block title %}{{ post.title }} - {{ 'blog.title'|trans }} - Biliardovna.sk{% endblock %}

{% block content %}
{% set home_path = language is defined and language == 'sk' ? '/' : '/' ~ language %}
{% set blog_path = language is defined and language == 'sk' ? '/blog' : '/' ~ language ~ '/blog' %}

<div class="post-page">
  <div class="container">
    <nav class="breadcrumbs" aria-label="Breadcrumb">
      <a href="{{ home_path }}">{{ 'nav.home'|trans }}</a>
      <span>/</span>
      <a href="{{ blog_path }}">{{ 'blog.title'|trans }}</a>
      <span>/</span>
      <span aria-current="page">{{ post.title }}</span>
    </nav>

    <article class="post" itemscope itemtype="https://schema.org/BlogPosting">
      <header class="post-header">
        <h1 class="post-title" itemprop="headline">{{ post.title }}</h1>

        <div class="post-meta">
          {% if post.published_at %}
            <time class="post-date" itemprop="datePublished" datetime="{{ post.published_at|date('c') }}">
              {{ post.published_at|date('d.m.Y') }}
            </time>
          {% endif %}
          {% if post.category %}
            <span class="post-category" itemprop="articleSection">{{ post.category }}</span>
          {% endif %}
          {% if post.author %}
            <span class="post-author">{{ 'blog.author'|trans }}: <span itemprop="author">{{ post.author }}</span></span>
          {% endif %}
        </div>
      </header>

      {% if post.image %}
      <div class="post-image">
        <img src="{{ post.image }}" alt="{{ post.title }}" loading="lazy" itemprop="image">
      </div>
      {% endif %}

      <div class="post-content" itemprop="articleBody">
        {{ post.content|raw }}
      </div>

      <footer class="post-footer">
        {% if post.tags %}
        <div class="post-tags">
          <strong>{{ 'blog.tags'|trans }}:</strong>
          {% for tag in post.tags %}
            <span class="tag" itemprop="keywords">{{ tag }}</span>
          {% endfor %}
        </div>
        {% endif %}

        <div class="post-share" data-share data-title="{{ post.title }}">
          <strong>{{ 'blog.share'|trans }}:</strong>
          <a href="#" target="_blank" rel="noopener noreferrer" class="share-link" data-network="facebook">Facebook</a>
          <a href="#" target="_blank" rel="noopener noreferrer" class="share-link" data-network="twitter">Twitter</a>
          <a href="#" target="_blank" rel="noopener noreferrer" class="share-link" data-network="linkedin">LinkedIn</a>
        </div>
      </footer>
    </article>

    <div class="post-navigation">
      {% if prev_post %}
      <a href="{{ prev_post.url }}" class="post-nav-link post-nav-prev" rel="prev" aria-label="{{ 'blog.previous_post'|trans }}">
        <span class="post-nav-label">← {{ 'blog.previous_post'|trans }}</span>
        <span class="post-nav-title">{{ prev_post.title }}</span>
      </a>
      {% endif %}

      {% if next_post %}
      <a href="{{ next_post.url }}" class="post-nav-link post-nav-next" rel="next" aria-label="{{ 'blog.next_post'|trans }}">
        <span class="post-nav-label">{{ 'blog.next_post'|trans }} →</span>
        <span class="post-nav-title">{{ next_post.title }}</span>
      </a>
      {% endif %}
    </div>

    <div class="back-to-blog">
      <a href="{{ blog_path }}" class="btn btn-secondary">← {{ 'blog.back_to_list'|trans }}</a>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
  var wrap = document.querySelector('.post-share[data-share]');
  if (!wrap) return;

  var url = encodeURIComponent(window.location.href);
  var text = encodeURIComponent(wrap.getAttribute('data-title') || document.title);

  wrap.querySelectorAll('.share-link').forEach(function (a) {
    var net = a.dataset.network;
    var href = '#';
    if (net === 'facebook') {
      href = 'https://www.facebook.com/sharer/sharer.php?u=' + url;
    } else if (net === 'twitter') {
      href = 'https://twitter.com/intent/tweet?url=' + url + '&text=' + text;
    } else if (net === 'linkedin') {
      href = 'https://www.linkedin.com/shareArticle?mini=true&url=' + url + '&title=' + text;
    }
    a.href = href;
  });
});
</script>
{% endblock %}